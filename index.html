<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <title>Porn · REAL TIME VAULT</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,300..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --bg-deep: #0a0a0e;
            --bg-surface: #14141a;
            --bg-elevated: #1e1e28;
            --bg-card: #23232f;
            --text-bright: #f0f0fa;
            --text-soft: #c5c5d5;
            --text-muted: #9090aa;
            --accent-primary: #b58b8b;
            --accent-secondary: #9d7373;
            --accent-deep: #7a5a5a;
            --border-light: rgba(160, 130, 130, 0.12);
            --border-medium: rgba(170, 140, 140, 0.2);
            --shadow-sm: 0 4px 12px rgba(0, 0, 0, 0.6);
            --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.8);
            --shadow-lg: 0 16px 48px rgba(0, 0, 0, 0.9);
            --radius-xs: 12px;
            --radius-sm: 20px;
            --radius-md: 28px;
            --radius-lg: 40px;
            --radius-xl: 60px;
            --radius-full: 9999px;
            --safe-top: env(safe-area-inset-top, 0px);
            --safe-bottom: env(safe-area-inset-bottom, 0px);
        }

        body {
            background: var(--bg-deep);
            color: var(--text-soft);
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            padding: clamp(8px, 2vw, 16px);
            padding-top: max(clamp(8px, 2vw, 16px), var(--safe-top));
            padding-bottom: max(clamp(8px, 2vw, 16px), var(--safe-bottom));
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        /* main container */
        .app {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: clamp(12px, 2vh, 20px);
        }

        /* ========== HEADER ========== */
        .header {
            background: rgba(20, 20, 28, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-xl);
            padding: clamp(8px, 2vw, 12px) clamp(12px, 3vw, 20px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow-sm);
        }

        .logo-wrap {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-full);
            background: linear-gradient(145deg, #252535, #1a1a26);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border-medium);
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .logo-icon:active {
            transform: scale(0.95);
        }

        .logo-icon i {
            font-size: 1.6rem;
            color: var(--accent-primary);
            opacity: 0.9;
        }

        .logo-text {
            font-size: clamp(1.2rem, 4vw, 1.6rem);
            font-weight: 350;
            color: var(--text-bright);
        }

        .logo-text span {
            color: var(--accent-primary);
            margin-left: 4px;
        }

        .stats-row {
            display: flex;
            gap: 8px;
        }

        .stat-pill {
            background: rgba(25, 25, 35, 0.7);
            backdrop-filter: blur(8px);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-full);
            padding: clamp(6px, 1.5vw, 10px) clamp(12px, 2.5vw, 18px);
            font-size: clamp(0.7rem, 2vw, 0.85rem);
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--text-muted);
        }

        .stat-pill i {
            color: var(--accent-secondary);
        }

        .stat-pill .value {
            color: var(--text-bright);
            font-weight: 500;
            margin-left: 4px;
        }

        /* ========== PANEL RAHASIA (TIDAK TERLIHAT) ========== */
        .secret-panel {
            background: rgba(18, 18, 26, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(150, 110, 110, 0.3);
            border-radius: var(--radius-lg);
            padding: clamp(20px, 4vw, 28px);
            display: none;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            box-shadow: var(--shadow-lg);
            animation: fadeScale 0.3s ease;
        }

        @keyframes fadeScale {
            from { opacity: 0; transform: scale(0.98); }
            to { opacity: 1; transform: scale(1); }
        }

        .secret-panel.visible {
            display: grid;
        }

        .secret-title {
            grid-column: 1 / -1;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--accent-primary);
            font-size: 1.1rem;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(150, 120, 120, 0.2);
        }

        .upload-zone {
            background: rgba(12, 12, 20, 0.8);
            border: 2px dashed rgba(150, 110, 110, 0.4);
            border-radius: var(--radius-md);
            padding: clamp(25px, 5vw, 35px) 20px;
            text-align: center;
            cursor: pointer;
            transition: 0.2s;
            grid-column: span 2;
        }

        .upload-zone:hover {
            border-color: var(--accent-secondary);
            background: rgba(25, 18, 22, 0.6);
        }

        .upload-zone i {
            font-size: 2.8rem;
            color: var(--accent-secondary);
            margin-bottom: 12px;
        }

        .input-field {
            background: rgba(15, 15, 22, 0.8);
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-full);
            padding: 14px 20px;
            color: var(--text-bright);
            font-size: 0.95rem;
            outline: none;
            width: 100%;
            transition: 0.2s;
        }

        .input-field:focus {
            border-color: var(--accent-primary);
            background: rgba(20, 18, 25, 0.9);
        }

        textarea.input-field {
            border-radius: var(--radius-md);
            resize: vertical;
            min-height: 90px;
        }

        .btn-primary {
            background: rgba(55, 40, 45, 0.9);
            border: 1px solid rgba(160, 120, 120, 0.5);
            border-radius: var(--radius-full);
            padding: 14px 24px;
            color: var(--accent-primary);
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: 0.2s;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary:hover {
            background: rgba(70, 50, 55, 0.95);
            border-color: var(--accent-primary);
            color: #f0d0d0;
        }

        /* ========== TOOLBAR ========== */
        .toolbar {
            background: rgba(22, 22, 30, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-xl);
            padding: clamp(8px, 2vw, 12px);
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 10px;
        }

        .search-box {
            flex: 2;
            min-width: 200px;
            background: rgba(15, 15, 22, 0.8);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            padding: 0 4px 0 16px;
        }

        .search-box input {
            flex: 1;
            background: transparent;
            border: none;
            padding: 12px 8px;
            color: var(--text-bright);
            font-size: 0.95rem;
            outline: none;
            min-width: 0;
        }

        .search-box input::placeholder {
            color: var(--text-muted);
            opacity: 0.7;
        }

        .search-box button {
            background: rgba(45, 35, 40, 0.8);
            border: none;
            border-radius: var(--radius-full);
            padding: 8px 18px;
            color: var(--accent-primary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: 0.2s;
        }

        .filter-wrap {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }

        .filter-item {
            background: rgba(28, 28, 36, 0.8);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-full);
            padding: 8px 16px;
            font-size: 0.8rem;
            color: var(--text-muted);
            cursor: pointer;
            transition: 0.2s;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .filter-item.active {
            background: rgba(90, 60, 60, 0.3);
            border-color: var(--accent-secondary);
            color: #e0c0c0;
        }

        .btn-icon {
            background: rgba(35, 35, 45, 0.8);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-full);
            padding: 8px 16px;
            color: var(--text-soft);
            cursor: pointer;
            transition: 0.2s;
            font-size: 0.8rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-icon.danger {
            background: rgba(70, 35, 35, 0.5);
            border-color: rgba(150, 80, 80, 0.3);
            color: #d0a0a0;
        }

        /* ========== GALLERY GRID ========== */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 16px;
            margin: 8px 0 16px;
        }

        @media (min-width: 600px) {
            .gallery {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
                gap: 20px;
            }
        }

        @media (min-width: 900px) {
            .gallery {
                grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
                gap: 24px;
            }
        }

        /* ========== CARD ========== */
        .card {
            background: rgba(26, 26, 36, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            overflow: hidden;
            transition: all 0.25s cubic-bezier(0.2, 0, 0, 1);
            display: flex;
            flex-direction: column;
            animation: cardRise 0.3s ease;
            box-shadow: var(--shadow-sm);
        }

        @keyframes cardRise {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card.deleting {
            animation: cardFall 0.2s forwards;
        }

        @keyframes cardFall {
            to { opacity: 0; transform: scale(0.9); }
        }

        .card:hover {
            transform: translateY(-4px);
            border-color: rgba(170, 130, 130, 0.3);
            box-shadow: var(--shadow-md);
            background: rgba(32, 30, 40, 0.8);
        }

        .card-media {
            aspect-ratio: 1 / 1;
            overflow: hidden;
            cursor: pointer;
            position: relative;
            border-bottom: 1px solid var(--border-light);
        }

        .card-media img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s;
            display: block;
            background: #1a1a26;
        }

        .card:hover .card-media img {
            transform: scale(1.06);
        }

        .download-badge {
            position: absolute;
            bottom: 12px;
            right: 12px;
            width: 42px;
            height: 42px;
            border-radius: var(--radius-full);
            background: rgba(20, 20, 30, 0.85);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(180, 130, 130, 0.5);
            color: var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            opacity: 0;
            transform: scale(0.8);
            transition: 0.2s;
            z-index: 5;
        }

        .card:hover .download-badge {
            opacity: 1;
            transform: scale(1);
        }

        .download-badge:hover {
            background: rgba(110, 60, 60, 0.9);
            color: white;
        }

        .card-content {
            padding: 14px 14px 12px;
        }

        .card-title {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-bright);
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .card-bio {
            font-size: 0.8rem;
            color: var(--text-muted);
            line-height: 1.4;
            margin-bottom: 14px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            min-height: 2.2em;
        }

        .card-actions {
            display: flex;
            gap: 6px;
            border-top: 1px dashed rgba(140, 110, 110, 0.2);
            padding-top: 10px;
        }

        .card-action-btn {
            flex: 1;
            background: rgba(30, 30, 40, 0.7);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-full);
            padding: 6px 0;
            font-size: 0.7rem;
            color: var(--text-muted);
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        .card-action-btn.delete:hover {
            background: rgba(90, 45, 45, 0.7);
            border-color: #a06a6a;
            color: #f0b0b0;
        }

        /* ========== MODAL ========== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(5, 5, 10, 0.96);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }

        .modal.active {
            display: flex;
        }

        .modal-dialog {
            background: rgba(22, 22, 32, 0.95);
            backdrop-filter: blur(32px);
            border: 1px solid rgba(160, 130, 130, 0.3);
            border-radius: var(--radius-lg);
            max-width: 1000px;
            width: 100%;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow-lg);
            animation: modalPop 0.3s;
        }

        @keyframes modalPop {
            from { opacity: 0; transform: scale(0.96); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-head {
            padding: 18px 24px;
            border-bottom: 1px solid var(--border-medium);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-head h2 {
            font-size: 1.4rem;
            font-weight: 400;
            color: var(--accent-primary);
        }

        .modal-close-btn {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-full);
            background: rgba(35, 30, 40, 0.8);
            border: 1px solid var(--border-medium);
            color: #aaa;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            cursor: pointer;
            transition: 0.2s;
        }

        .modal-close-btn:hover {
            background: rgba(70, 45, 50, 0.9);
            color: white;
        }

        .modal-body {
            display: flex;
            flex-wrap: wrap;
            overflow-y: auto;
            max-height: calc(90vh - 80px);
        }

        .modal-img {
            flex: 1 1 280px;
            padding: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(10, 10, 18, 0.6);
        }

        .modal-img img {
            max-width: 100%;
            max-height: 50vh;
            object-fit: contain;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-md);
        }

        .modal-info {
            flex: 1 1 260px;
            padding: 24px;
            border-left: 1px solid var(--border-light);
        }

        .modal-info h3 {
            font-size: 1.8rem;
            font-weight: 350;
            color: var(--text-bright);
            margin-bottom: 16px;
            word-break: break-word;
        }

        .modal-info p {
            color: var(--text-soft);
            line-height: 1.7;
            margin-bottom: 28px;
            font-size: 0.95rem;
            word-break: break-word;
        }

        .modal-download-btn {
            background: rgba(50, 40, 48, 0.9);
            border: 1px solid rgba(170, 130, 130, 0.5);
            border-radius: var(--radius-full);
            padding: 16px 28px;
            color: var(--accent-primary);
            font-size: 1rem;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            font-weight: 500;
        }

        .modal-download-btn:hover {
            background: rgba(80, 50, 55, 0.95);
            border-color: var(--accent-primary);
            color: #f0d0d0;
        }

        /* ========== FOOTER ========== */
        .footer {
            margin-top: 16px;
            padding: 14px 20px;
            background: rgba(18, 18, 26, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-xl);
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        .empty-gallery {
            grid-column: 1 / -1;
            text-align: center;
            padding: 60px 30px;
            background: rgba(22, 22, 32, 0.5);
            backdrop-filter: blur(8px);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-light);
            color: var(--text-muted);
        }

        /* touch optimization */
        button, .filter-item, .card-action-btn, .download-badge, .logo-icon {
            min-height: 44px;
            min-width: 44px;
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- HEADER -->
        <div class="header">
            <div class="logo-wrap">
                <div class="logo-icon" id="secretTrigger">
                    <i class="fa-regular fa-circle"></i>
                </div>
                <div class="logo-text">Porn<span>·18+</span></div>
            </div>
            <div class="stats-row">
                <div class="stat-pill"><i class="fa-regular fa-images"></i> <span class="value" id="totalCount">0</span></div>
                <div class="stat-pill"><i class="fa-regular fa-eye"></i> <span class="value" id="shownCount">0</span></div>
            </div>
        </div>

        <!-- SECRET PANEL (10x klik) -->
        <div class="secret-panel" id="secretPanel">
            <div class="secret-title"><i class="fa-regular fa-lock-open"></i> ADMIN · UPLOAD</div>
            <div class="upload-zone" id="uploadZone">
                <i class="fa-regular fa-cloud-arrow-up"></i>
                <p style="margin-bottom: 8px;">Klik untuk pilih foto</p>
                <p style="font-size: 0.75rem; opacity: 0.6;">(tersimpan permanen)</p>
                <input type="file" id="fileInput" accept="image/*" style="display: none;">
            </div>
            <div style="display: flex; flex-direction: column; gap: 12px;">
                <input type="text" class="input-field" id="photoName" placeholder="Nama / judul" maxlength="50">
                <textarea class="input-field" id="photoBio" placeholder="Bio / deskripsi" rows="2" maxlength="150"></textarea>
                <button class="btn-primary" id="addPhotoBtn"><i class="fa-regular fa-plus"></i> Tambah Foto</button>
            </div>
        </div>

        <!-- TOOLBAR -->
        <div class="toolbar">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Cari...">
                <button><i class="fa-regular fa-magnifying-glass"></i></button>
            </div>
            <div class="filter-wrap">
                <div class="filter-item active" data-filter="all">Semua</div>
                <div class="filter-item" data-filter="short">Pendek</div>
                <div class="filter-item" data-filter="long">Panjang</div>
            </div>
            <div style="display: flex; gap: 4px; margin-left: auto;">
                <button class="btn-icon" id="resetBtn"><i class="fa-regular fa-rotate-left"></i></button>
                <button class="btn-icon danger" id="deleteAllBtn"><i class="fa-regular fa-trash-can"></i></button>
            </div>
        </div>

        <!-- GALLERY -->
        <div class="gallery" id="gallery"></div>

        <!-- FOOTER -->
        <div class="footer">
            <div><i class="fa-regular fa-circle"></i> real-time vault</div>
            <div id="itemCounter">0 item</div>
        </div>
    </div>

    <!-- MODAL -->
    <div class="modal" id="modal">
        <div class="modal-dialog">
            <div class="modal-head">
                <h2 id="modalName"></h2>
                <div class="modal-close-btn" id="closeModal"><i class="fa-regular fa-xmark"></i></div>
            </div>
            <div class="modal-body">
                <div class="modal-img">
                    <img id="modalImg" src="" alt="">
                </div>
                <div class="modal-info">
                    <h3 id="modalDetailName"></h3>
                    <p id="modalDetailBio"></p>
                    <button class="modal-download-btn" id="downloadModalBtn"><i class="fa-regular fa-download"></i> Download</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        (function() {
            // ========== STATE ==========
            let photos = [];
            let filter = 'all';
            let search = '';
            let secretClicks = 0;
            const SECRET_MAX = 10;
            let uploadLock = false; // Mencegah double upload

            // DOM elements
            const gallery = document.getElementById('gallery');
            const totalSpan = document.getElementById('totalCount');
            const shownSpan = document.getElementById('shownCount');
            const itemCounter = document.getElementById('itemCounter');
            const secretTrigger = document.getElementById('secretTrigger');
            const secretPanel = document.getElementById('secretPanel');
            const uploadZone = document.getElementById('uploadZone');
            const fileInput = document.getElementById('fileInput');
            const photoName = document.getElementById('photoName');
            const photoBio = document.getElementById('photoBio');
            const addBtn = document.getElementById('addPhotoBtn');
            const searchInput = document.getElementById('searchInput');
            const filterItems = document.querySelectorAll('[data-filter]');
            const resetBtn = document.getElementById('resetBtn');
            const deleteAllBtn = document.getElementById('deleteAllBtn');
            const modal = document.getElementById('modal');
            const modalImg = document.getElementById('modalImg');
            const modalName = document.getElementById('modalName');
            const modalDetailName = document.getElementById('modalDetailName');
            const modalDetailBio = document.getElementById('modalDetailBio');
            const downloadModalBtn = document.getElementById('downloadModalBtn');
            const closeModal = document.getElementById('closeModal');

            // ========== LOAD DATA ==========
            function loadData() {
                try {
                    const saved = localStorage.getItem('porn_18+');
                    if (saved) {
                        photos = JSON.parse(saved);
                    } else {
                        // default data
                        photos = [
                            { id: '1', name: 'Senja', bio: 'Golden hour di puncak bukit', url: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400' },
                            { id: '2', name: 'Hutan', bio: 'Kabut pagi di antara pepohonan', url: 'https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?w=400' },
                            { id: '3', name: 'Bulan', bio: 'Malam dengan rembulan di langit', url: 'https://images.unsplash.com/photo-1532767153582-b1a0e5145009?w=400' },
                            { id: '4', name: 'Kota', bio: 'Siluet gedung pencakar langit', url: 'https://images.unsplash.com/photo-1518005020951-eccb494ad742?w=400' }
                        ];
                    }
                } catch(e) {
                    photos = [];
                }
            }

            // ========== SAVE DATA ==========
            function saveData() {
                localStorage.setItem('porn_18+', JSON.stringify(photos));
            }

            // ========== DOWNLOAD FUNCTION ==========
            async function downloadPhoto(src, name) {
                try {
                    if (src.startsWith('data:')) {
                        const link = document.createElement('a');
                        link.href = src;
                        link.download = (name || 'foto').replace(/[^a-z0-9]/gi, '_') + '.jpg';
                        link.click();
                        return;
                    }
                    const res = await fetch(src, { mode: 'cors' });
                    const blob = await res.blob();
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = (name || 'foto').replace(/[^a-z0-9]/gi, '_') + '.jpg';
                    link.click();
                    setTimeout(() => URL.revokeObjectURL(url), 100);
                } catch(e) {
                    alert('Download gagal. Gunakan foto upload sendiri.');
                }
            }

            // ========== FILTER ==========
            function getFiltered() {
                return photos.filter(p => {
                    const match = (p.name + ' ' + p.bio).toLowerCase().includes(search.toLowerCase());
                    if (!match) return false;
                    if (filter === 'all') return true;
                    if (filter === 'short') return (p.bio || '').length < 50;
                    if (filter === 'long') return (p.bio || '').length >= 50;
                    return true;
                });
            }

            // ========== RENDER ==========
            function render() {
                const filtered = getFiltered();
                totalSpan.innerText = photos.length;
                shownSpan.innerText = filtered.length;
                itemCounter.innerText = filtered.length + ' item';

                if (filtered.length === 0) {
                    gallery.innerHTML = '<div class="empty-gallery"><i class="fa-regular fa-image"></i><br>Tidak ada foto</div>';
                    return;
                }

                let html = '';
                filtered.forEach(p => {
                    html += `
                        <div class="card" data-id="${p.id}">
                            <div class="card-media">
                                <img src="${p.url}" alt="${p.name}" loading="lazy" crossorigin="anonymous">
                                <div class="download-badge" data-id="${p.id}"><i class="fa-regular fa-download"></i></div>
                            </div>
                            <div class="card-content">
                                <div class="card-title">${escapeHtml(p.name) || 'Tanpa Nama'}</div>
                                <div class="card-bio">${escapeHtml(p.bio) || '—'}</div>
                                <div class="card-actions">
                                    <button class="card-action-btn preview-btn" data-id="${p.id}"><i class="fa-regular fa-eye"></i> Lihat</button>
                                    <button class="card-action-btn delete" data-id="${p.id}"><i class="fa-regular fa-trash-can"></i> Hapus</button>
                                </div>
                            </div>
                        </div>
                    `;
                });
                gallery.innerHTML = html;

                // Attach events
                document.querySelectorAll('.preview-btn, .card-media').forEach(el => {
                    el.addEventListener('click', (e) => {
                        if (e.target.closest('.download-badge')) return;
                        const id = el.closest('.card')?.dataset.id;
                        const p = photos.find(x => x.id === id);
                        if (p) {
                            modalImg.src = p.url;
                            modalName.innerText = p.name;
                            modalDetailName.innerText = p.name;
                            modalDetailBio.innerText = p.bio || 'Tidak ada bio';
                            downloadModalBtn.onclick = () => downloadPhoto(p.url, p.name);
                            modal.classList.add('active');
                        }
                    });
                });

                document.querySelectorAll('.download-badge').forEach(badge => {
                    badge.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const id = badge.dataset.id;
                        const p = photos.find(x => x.id === id);
                        if (p) downloadPhoto(p.url, p.name);
                    });
                });

                document.querySelectorAll('.delete').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const id = btn.dataset.id;
                        const card = btn.closest('.card');
                        if (card) card.classList.add('deleting');
                        setTimeout(() => {
                            photos = photos.filter(x => x.id !== id);
                            saveData();
                            render();
                        }, 180);
                    });
                });
            }

            // Escape HTML
            function escapeHtml(str) {
                if (!str) return str;
                return str.replace(/[&<>"]/g, function(m) {
                    if (m === '&') return '&amp;';
                    if (m === '<') return '&lt;';
                    if (m === '>') return '&gt;';
                    if (m === '"') return '&quot;';
                    return m;
                });
            }

            // ========== SECRET TRIGGER (10x, no visual) ==========
            secretTrigger.addEventListener('click', () => {
                secretClicks++;
                if (secretClicks >= SECRET_MAX) {
                    secretPanel.classList.toggle('visible');
                    secretClicks = 0;
                }
                // reset after 3 seconds to avoid accidental stacking
                setTimeout(() => { secretClicks = 0; }, 3000);
            });

            // ========== UPLOAD (FIX: NO DUPLICATE) ==========
            uploadZone.addEventListener('click', () => {
                fileInput.value = ''; // reset biar bisa pilih file yang sama
                fileInput.click();
            });

            fileInput.addEventListener('change', function(e) {
                if (uploadLock) return; // prevent double
                if (!this.files || !this.files[0]) return;

                uploadLock = true;
                const file = this.files[0];
                if (!file.type.startsWith('image/')) {
                    alert('File harus gambar');
                    uploadLock = false;
                    return;
                }

                // auto-fill name jika kosong
                if (!photoName.value.trim()) {
                    photoName.value = file.name.split('.')[0].replace(/[_-]/g, ' ');
                }

                // baca file
                const reader = new FileReader();
                reader.onload = (ev) => {
                    // langsung push ke photos (real-time)
                    const newPhoto = {
                        id: 'p' + Date.now() + '_' + Math.random().toString(36).substr(2, 6),
                        name: photoName.value.trim() || file.name.split('.')[0],
                        bio: photoBio.value.trim() || '',
                        url: ev.target.result
                    };
                    photos.push(newPhoto);
                    saveData();
                    render();

                    // reset form & unlock
                    photoName.value = '';
                    photoBio.value = '';
                    fileInput.value = '';
                    uploadLock = false;
                };
                reader.onerror = () => {
                    alert('Gagal membaca file');
                    uploadLock = false;
                };
                reader.readAsDataURL(file);
            });

            addBtn.addEventListener('click', () => {
                if (!fileInput.files || !fileInput.files[0]) {
                    alert('Pilih foto dulu!');
                    return;
                }
                // trigger change manually
                fileInput.dispatchEvent(new Event('change'));
            });

            // ========== SEARCH ==========
            searchInput.addEventListener('input', (e) => {
                search = e.target.value;
                render();
            });

            // ========== FILTER ==========
            filterItems.forEach(item => {
                item.addEventListener('click', () => {
                    filterItems.forEach(f => f.classList.remove('active'));
                    item.classList.add('active');
                    filter = item.dataset.filter;
                    render();
                });
            });

            // ========== RESET DEFAULT ==========
            resetBtn.addEventListener('click', () => {
                if (confirm('Reset ke foto default?')) {
                    photos = [
                        { id: '1', name: 'Senja', bio: 'Golden hour di puncak bukit', url: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400' },
                        { id: '2', name: 'Hutan', bio: 'Kabut pagi di antara pepohonan', url: 'https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?w=400' },
                        { id: '3', name: 'Bulan', bio: 'Malam dengan rembulan di langit', url: 'https://images.unsplash.com/photo-1532767153582-b1a0e5145009?w=400' },
                        { id: '4', name: 'Kota', bio: 'Siluet gedung pencakar langit', url: 'https://images.unsplash.com/photo-1518005020951-eccb494ad742?w=400' }
                    ];
                    saveData();
                    render();
                }
            });

            // ========== DELETE ALL ==========
            deleteAllBtn.addEventListener('click', () => {
                if (confirm('Hapus SEMUA foto?')) {
                    photos = [];
                    saveData();
                    render();
                }
            });

            // ========== MODAL CLOSE ==========
            closeModal.addEventListener('click', () => modal.classList.remove('active'));
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.classList.remove('active');
            });

            // ESC key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') modal.classList.remove('active');
            });

            // ========== INIT ==========
            loadData();
            render();
        })();
    </script>
</body>
</html>